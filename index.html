<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Control de Pallets</title>

<style>
* { box-sizing: border-box; font-family: Arial, sans-serif; }

body {
  margin: 0;
  background: #eef1f4;
}

/* HEADER */
header {
  background: #1976d2;
  color: white;
  padding: 15px;
  display: flex;
  align-items: center;
}

header button {
  background: none;
  border: none;
  color: white;
  font-size: 22px;
  margin-right: 15px;
}

/* SIDEBAR */
#sidebar {
  position: fixed;
  top: 0;
  left: -260px;
  width: 260px;
  height: 100%;
  background: #263238;
  color: white;
  padding-top: 60px;
  transition: 0.3s;
  z-index: 1000;
}

#sidebar button {
  width: 100%;
  padding: 15px;
  background: none;
  border: none;
  color: white;
  text-align: left;
  font-size: 16px;
}

#sidebar button:hover {
  background: #37474f;
}

/* CONTENT */
main {
  padding: 20px;
}

.section {
  display: none;
  background: white;
  padding: 20px;
  border-radius: 10px;
}

.section.active {
  display: block;
}

.card {
  background: white;
  padding: 15px;
  border-radius: 10px;
  margin-bottom: 15px;
  border-left: 6px solid #2e7d32;
}

.salido {
  border-left-color: #c62828;
  opacity: 0.9;
}

input, select, button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
}

.btn {
  background: #1976d2;
  color: white;
  border: none;
  margin-top: 10px;
}

.btn-mover { background: #f57c00; }
.btn-salida { background: #d32f2f; }
</style>
</head>

<body>

<header>
  <button onclick="toggleMenu()">‚ò∞</button>
  <h2>CONTROL DE PALLETS</h2>
</header>

<div id="sidebar">
  <button onclick="showSection('registro')">üì¶ Registrar Pallet</button>
  <button onclick="showSection('almacenados')">üìç Almacenados</button>
  <button onclick="showSection('rack')">üß± Por Rack</button>
  <button onclick="showSection('salidos')">üöö Salidos</button>
</div>

<main>

<!-- REGISTRO -->
<div id="registro" class="section active">
  <h3>Registrar Pallet</h3>

  <input id="numero" type="number" placeholder="N¬∞ Pallet">
  <select id="producto">
    <option>Palta</option>
    <option>Mango</option>
    <option>Uva</option>
    <option>Ar√°ndano</option>
    <option>Fresa</option>
  </select>
  <input id="detalle" placeholder="Detalle / Presentaci√≥n">
  <input id="cajas" type="number" placeholder="Cajas">
  <input id="rack" placeholder="Rack">
  <input id="riel" type="number" placeholder="Riel">
  <input id="nivel" type="number" placeholder="Nivel">
  <input id="fondo" type="number" placeholder="Fondo">

  <button class="btn" onclick="guardar()">Guardar</button>
</div>

<!-- ALMACENADOS -->
<div id="almacenados" class="section">
  <h3>Pallets Almacenados</h3>
  <div id="listadoAlmacenados"></div>
</div>

<!-- POR RACK -->
<div id="rack" class="section">
  <h3>Buscar por Rack</h3>
  <input id="rackFiltro" placeholder="Ej: A">
  <button class="btn" onclick="verPorRack()">Ver Rack</button>
  <div id="listadoRack"></div>
</div>

<!-- SALIDOS -->
<div id="salidos" class="section">
  <h3>Pallets Salidos</h3>
  <div id="listadoSalidos"></div>
</div>

</main>

<script>
let pallets = JSON.parse(localStorage.getItem("pallets")) || [];

function toggleMenu() {
  const s = document.getElementById("sidebar");
  s.style.left = s.style.left === "0px" ? "-260px" : "0px";
}

function showSection(id) {
  document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  toggleMenu();
  render();
}

function guardar() {
  pallets.push({
    numero: numero.value,
    producto: producto.value,
    detalle: detalle.value,
    cajas: cajas.value,
    rack: rack.value.toUpperCase(),
    riel: riel.value,
    nivel: nivel.value,
    fondo: fondo.value,
    estado: "almacenado"
  });
  localStorage.setItem("pallets", JSON.stringify(pallets));
  alert("Pallet registrado");
}

function render() {
  document.getElementById("listadoAlmacenados").innerHTML =
    pallets.filter(p => p.estado === "almacenado")
    .map(p => card(p)).join("");

  document.getElementById("listadoSalidos").innerHTML =
    pallets.filter(p => p.estado === "salido")
    .map(p => card(p,true)).join("");
}

function card(p, salido=false) {
  return `
    <div class="card ${salido ? 'salido':''}">
      <strong>Pallet ${p.numero}</strong><br>
      ${p.producto} ${p.detalle}<br>
      Rack ${p.rack} - Riel ${p.riel} - Nivel ${p.nivel} - Fondo ${p.fondo}
      ${!salido ? `
      <button class="btn-mover" onclick="mover(${p.numero})">Mover</button>
      <button class="btn-salida" onclick="salida(${p.numero})">Salida</button>` : ''}
    </div>`;
}

function mover(n) {
  const p = pallets.find(p => p.numero == n);
  p.rack = prompt("Rack:", p.rack);
  p.riel = prompt("Riel:", p.riel);
  p.nivel = prompt("Nivel:", p.nivel);
  p.fondo = prompt("Fondo:", p.fondo);
  localStorage.setItem("pallets", JSON.stringify(pallets));
  render();
}

function salida(n) {
  pallets.find(p => p.numero == n).estado = "salido";
  localStorage.setItem("pallets", JSON.stringify(pallets));
  render();
}

function verPorRack() {
  const r = rackFiltro.value.toUpperCase();
  document.getElementById("listadoRack").innerHTML =
    pallets.filter(p => p.rack === r && p.estado === "almacenado")
    .map(p => card(p)).join("");
}

render();
</script>

</body>
</html>
